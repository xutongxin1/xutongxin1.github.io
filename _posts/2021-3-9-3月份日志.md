---


layout: post
title: 3月份日志
categories: 日志
tags: 
    - 开发 
    - 日志
BGImage: 'https://raw.githubusercontent.com/xutongxin1/xutongxin1.github.io/master/asset/%E6%97%A5%E5%BF%97/202020210225100750.png'
jekyll-theme-WuK:
    musicid: '28225846'

---

## 3.9

继续开工

先弄弄**DMA**

```c
(uint8_t *)t
```

将变量类型强制转换为uint8 *类型

```c
volatile uint8_t rx_len ;  //接收一帧数据的长度
```

volatile关键词影响编译器编译的结果，用volatile声明的变量表示该变量随时可能发生变化，与该变量有关的运算，不要进行编译优化，以免出错

USART的中断类型比你想象的要多

```
UART_IT_CTS：CTS更改中断

UART_IT_LBD：LIN中断检测中断

UART_IT_TXE：发送数据寄存器为空中断

UART_IT_TC：发送完成中断

UART_IT_RXNE：接收数据寄存器不为空中断

UART_IT_IDLE：空闲线检测中断

UART_IT_PE：奇偶校验错误中断

UART_IT_ERR：错误中断（帧错误，噪声错误，溢出错误）
```

开启语句

```c
__HAL_UART_ENABLE_IT(&huart1, UART_IT_IDLE); //启动IDLE中断
```

全局变量办法

在一个头文件先**定义**

```c
//user.h
#ifndef DMA_USER_H
#define DMA_USER_H

extern uint8_t  rx_buffer[100];
#endif //DMA_USER_H
```

然后在main.c的main()外面**声明**

```c
//main.h
//需要先#include "user.h"
/* USER CODE BEGIN PV */
uint8_t  rx_buffer[100];
/* USER CODE END PV */
```

然后该项目所有文件直接引用user.h即可

## 3.15

尝试造esp8266的无线调试器，模块用的是Esp-wroom-02d，记录几个点

1. EN脚理论上其实不是直接上电，而是加一个延时电路

2. 烧录时GPIO15和GPIO0都要拉低，但是运行时GPIO0置空，GPIO15似乎还是要拉低

3. 烧录命令可以在构建完之后看到，GUI版本的烧录器没有验证（Flash容量没得选）

   如：python "C:\Users\xtx\OneDrive - xutongxin\ESP8266\DAP\pytool\esptool\esptool.py" -p COM16 -b 921600 --after hard_reset write_flash --flash_mode dio --flash_size 16MB --flash_freq 80m 0x0 bootloader.bin 0x8000 partition-table.bin 0x10000 esp8266_dap.bin

4. esptool可以直接用rtos-sdk里的，pip直接安装不太好用。同时要先装pip install pyserical

5. bootloader.bin和partition-table.bin也在rtos-sdk里，直接在Github Action提取出来即可



然后是Github Action功能，就是在线构建功能

1. 如果直接按着main.yml对着ubuntu虚拟机这样做是不行的，所以不能线下复现
2. 提取出文件的方案(记得重新校对排版),然后在action界面可以看到

```yaml
 - name: Deliver firmware

   uses: actions/upload-artifact@v2

   with:

     name: pytool

     path: ./ESP8266_RTOS_SDK/components/esptool_py



 - name: Deliver firmware1

   uses: actions/upload-artifact@v2

   with:

​    name: pytool2

​    path: ./idf.py


```

至于利用发布功能提取文件就算了吧

3. 
4. 